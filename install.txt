æ–¹æ¡ˆ2ï¼šä½¿ç”¨condaç®¡ç† (æ¨è)

  # 1. å®‰è£…Minicondaæˆ–Anaconda
  # ä¸‹è½½ï¼šhttps://docs.conda.io/en/latest/miniconda.html

  # 2. åˆ›å»ºPython 3.10ç¯å¢ƒ
  conda create -n im_detector python=3.10

  # 3. æ¿€æ´»ç¯å¢ƒ
  conda activate im_detector

  # 4. å®‰è£…PyTorch (æ¨èå…ˆå®‰è£…)
  # CPUç‰ˆæœ¬:
  conda install pytorch torchvision torchaudio cpuonly -c pytorch

  # GPUç‰ˆæœ¬ (CUDA 11.8):
  conda install pytorch torchvision torchaudio pytorch-cuda=11.8 -c pytorch -c nvidia

  # 5. å®‰è£…å…¶ä»–ä¾èµ–
  pip install ultralytics opencv-python openai pandas pyyaml tqdm

  ğŸš¨ å¸¸è§å®‰è£…é—®é¢˜å’Œè§£å†³æ–¹æ¡ˆ

  é—®é¢˜1ï¼šPyTorchå®‰è£…å¤±è´¥

  # è§£å†³æ–¹æ¡ˆï¼šæ‰‹åŠ¨å®‰è£…PyTorch
  # è®¿é—® https://pytorch.org/get-started/locally/ è·å–æ­£ç¡®å‘½ä»¤

  # ç¤ºä¾‹ï¼š
  # CUDA 11.8:
  pip3 install torch torchvision torchaudio --index-url https://download.pytorch.org/whl/cu118

  # CPUç‰ˆæœ¬:
  pip3 install torch torchvision torchaudio --index-url https://download.pytorch.org/whl/cpu

  # macOS (Metal):
  pip3 install torch torchvision torchaudio

  é—®é¢˜2ï¼šOpenCVå®‰è£…å¤±è´¥

  # è§£å†³æ–¹æ¡ˆï¼š
  # æ–¹æ¡ˆA: ä½¿ç”¨opencv-python-headless (æ— GUIä¾èµ–)
  pip install opencv-python-headless

  # æ–¹æ¡ˆB: ç³»ç»Ÿçº§ä¾èµ–
  # Ubuntu:
  sudo apt-get install python3-opencv

  # macOS:
  brew install opencv

  é—®é¢˜3ï¼šUltralyticså®‰è£…å¤±è´¥

  # è§£å†³æ–¹æ¡ˆï¼šä»æºç å®‰è£…
  pip install git+https://github.com/ultralytics/ultralytics.git

  # æˆ–è€…é™çº§ç‰ˆæœ¬
  pip install ultralytics==8.0.120

  ğŸ“‹ å®Œæ•´çš„åˆ†æ­¥å®‰è£…è„šæœ¬

  åˆ›å»º install.sh (Linux/macOS) æˆ– install.bat (Windows)ï¼š

  #!/bin/bash
  # install.sh - Linux/macOSå®‰è£…è„šæœ¬

  echo "ğŸ IMæ£€æµ‹å™¨å®‰è£…è„šæœ¬"
  echo "===================="

  # æ£€æŸ¥Pythonç‰ˆæœ¬
  PYTHON_VERSION=$(python3 -c "import sys; print(f'{sys.version_info.major}.{sys.version_info.minor}')")
  echo "å½“å‰Pythonç‰ˆæœ¬: $PYTHON_VERSION"

  if [[ $(echo "$PYTHON_VERSION < 3.8" | bc) -eq 1 ]]; then
      echo "âŒ Pythonç‰ˆæœ¬è¿‡ä½ï¼Œéœ€è¦3.8+"
      exit 1
  fi

  # åˆ›å»ºè™šæ‹Ÿç¯å¢ƒ
  echo "ğŸ“¦ åˆ›å»ºè™šæ‹Ÿç¯å¢ƒ..."
  python3 -m venv im_detector_env

  # æ¿€æ´»ç¯å¢ƒ
  echo "ğŸ”§ æ¿€æ´»ç¯å¢ƒ..."
  source im_detector_env/bin/activate

  # å‡çº§pip
  echo "â¬†ï¸ å‡çº§pip..."
  pip install --upgrade pip

  # æ£€æµ‹GPU
  echo "ğŸ” æ£€æµ‹GPU..."
  if command -v nvidia-smi &> /dev/null; then
      echo "âœ… æ£€æµ‹åˆ°NVIDIA GPUï¼Œå®‰è£…GPUç‰ˆæœ¬PyTorch"
      pip install torch torchvision torchaudio --index-url https://download.pytorch.org/whl/cu118
  else
      echo "â„¹ï¸ æœªæ£€æµ‹åˆ°GPUï¼Œå®‰è£…CPUç‰ˆæœ¬PyTorch"
      pip install torch torchvision torchaudio --index-url https://download.pytorch.org/whl/cpu
  fi

  # å®‰è£…å…¶ä»–ä¾èµ–
  echo "ğŸ“š å®‰è£…å…¶ä»–ä¾èµ–..."
  pip install ultralytics>=8.0.0
  pip install opencv-python>=4.8.0
  pip install openai>=1.0.0
  pip install numpy>=1.24.0
  pip install Pillow>=10.0.0
  pip install pandas>=2.0.0
  pip install pyyaml>=6.0.0
  pip install tqdm>=4.65.0

  # éªŒè¯å®‰è£…
  echo "âœ… éªŒè¯å®‰è£…..."
  python -c "
  import torch
  import ultralytics
  import cv2
  import openai
  print('âœ… æ‰€æœ‰ä¾èµ–å®‰è£…æˆåŠŸï¼')
  print(f'PyTorchç‰ˆæœ¬: {torch.__version__}')
  print(f'CUDAå¯ç”¨: {torch.cuda.is_available()}')
  "

  echo "ğŸ‰ å®‰è£…å®Œæˆï¼"
  echo "æ¿€æ´»ç¯å¢ƒ: source im_detector_env/bin/activate"

  ğŸ›  Windowsæ‰¹å¤„ç†å®‰è£…è„šæœ¬

  @echo off
  REM install.bat - Windowså®‰è£…è„šæœ¬

  echo ğŸ IMæ£€æµ‹å™¨å®‰è£…è„šæœ¬
  echo ====================

  REM æ£€æŸ¥Python
  python --version >nul 2>&1
  if errorlevel 1 (
      echo âŒ æœªæ‰¾åˆ°Pythonï¼Œè¯·å…ˆå®‰è£…Python 3.10
      echo ä¸‹è½½åœ°å€: https://www.python.org/downloads/
      pause
      exit /b 1
  )

  REM åˆ›å»ºè™šæ‹Ÿç¯å¢ƒ
  echo ğŸ“¦ åˆ›å»ºè™šæ‹Ÿç¯å¢ƒ...
  python -m venv im_detector_env

  REM æ¿€æ´»ç¯å¢ƒ
  echo ğŸ”§ æ¿€æ´»ç¯å¢ƒ...
  call im_detector_env\Scripts\activate.bat

  REM å‡çº§pip
  echo â¬†ï¸ å‡çº§pip...
  python -m pip install --upgrade pip

  REM æ£€æµ‹GPU
  echo ğŸ” æ£€æµ‹GPU...
  nvidia-smi >nul 2>&1
  if errorlevel 1 (
      echo â„¹ï¸ æœªæ£€æµ‹åˆ°GPUï¼Œå®‰è£…CPUç‰ˆæœ¬
      pip install torch torchvision torchaudio --index-url https://download.pytorch.org/whl/cpu
  ) else (
      echo âœ… æ£€æµ‹åˆ°GPUï¼Œå®‰è£…GPUç‰ˆæœ¬
      pip install torch torchvision torchaudio --index-url https://download.pytorch.org/whl/cu118
  )

  REM å®‰è£…å…¶ä»–ä¾èµ–
  echo ğŸ“š å®‰è£…å…¶ä»–ä¾èµ–...
  pip install ultralytics opencv-python openai numpy Pillow pandas pyyaml tqdm

  REM éªŒè¯å®‰è£…
  echo âœ… éªŒè¯å®‰è£…...
  python -c "import torch, ultralytics, cv2, openai; print('âœ… å®‰è£…æˆåŠŸï¼')"

  echo ğŸ‰ å®‰è£…å®Œæˆï¼
  echo æ¿€æ´»ç¯å¢ƒ: im_detector_env\Scripts\activate.bat
  pause

  ğŸ”§ å¿«é€ŸéªŒè¯è„šæœ¬

  åˆ›å»º verify_install.pyï¼š

  #!/usr/bin/env python3
  """éªŒè¯å®‰è£…æ˜¯å¦æˆåŠŸ"""

  import sys

  def check_python_version():
      """æ£€æŸ¥Pythonç‰ˆæœ¬"""
      version = sys.version_info
      print(f"Pythonç‰ˆæœ¬: {version.major}.{version.minor}.{version.micro}")

      if version.major < 3 or (version.major == 3 and version.minor < 8):
          print("âŒ Pythonç‰ˆæœ¬è¿‡ä½ï¼Œéœ€è¦3.8+")
          return False
      elif version.major == 3 and version.minor >= 12:
          print("âš ï¸ Pythonç‰ˆæœ¬è¾ƒæ–°ï¼Œå¯èƒ½æœ‰å…¼å®¹æ€§é—®é¢˜")
      else:
          print("âœ… Pythonç‰ˆæœ¬ç¬¦åˆè¦æ±‚")

      return True

  def check_packages():
      """æ£€æŸ¥å…³é”®åŒ…"""
      packages = {
          'torch': 'PyTorch',
          'ultralytics': 'YOLO',
          'cv2': 'OpenCV',
          'openai': 'OpenAI API',
          'numpy': 'NumPy',
          'PIL': 'Pillow',
          'pandas': 'Pandas',
          'yaml': 'PyYAML',
          'tqdm': 'TQDM'
      }

      success = True

      for package, name in packages.items():
          try:
              if package == 'cv2':
                  import cv2
                  print(f"âœ… {name}: {cv2.__version__}")
              elif package == 'PIL':
                  from PIL import Image
                  print(f"âœ… {name}: {Image.__version__}")
              elif package == 'yaml':
                  import yaml
                  print(f"âœ… {name}: å·²å®‰è£…")
              else:
                  module = __import__(package)
                  version = getattr(module, '__version__', 'æœªçŸ¥ç‰ˆæœ¬')
                  print(f"âœ… {name}: {version}")

          except ImportError:
              print(f"âŒ {name}: æœªå®‰è£…")
              success = False

      return success

  def check_gpu():
      """æ£€æŸ¥GPUæ”¯æŒ"""
      try:
          import torch

          if torch.cuda.is_available():
              gpu_count = torch.cuda.device_count()
              gpu_name = torch.cuda.get_device_name(0)
              print(f"âœ… CUDA: {gpu_count}ä¸ªGPU ({gpu_name})")
          else:
              print("â„¹ï¸ CUDA: æœªæ£€æµ‹åˆ°GPUï¼Œå°†ä½¿ç”¨CPU")

      except ImportError:
          print("âŒ æ— æ³•æ£€æŸ¥GPUçŠ¶æ€")

  def main():
      print("ğŸ” éªŒè¯IMæ£€æµ‹å™¨å®‰è£…ç¯å¢ƒ")
      print("=" * 30)

      # æ£€æŸ¥Pythonç‰ˆæœ¬
      if not check_python_version():
          sys.exit(1)

      print("\nğŸ“¦ æ£€æŸ¥ä¾èµ–åŒ…:")
      if not check_packages():
          print("\nâŒ éƒ¨åˆ†ä¾èµ–åŒ…æœªå®‰è£…ï¼Œè¯·è¿è¡Œ:")
          print("pip install -r requirements.txt")
          sys.exit(1)

      print("\nğŸš€ æ£€æŸ¥GPUæ”¯æŒ:")
      check_gpu()

      print("\nğŸ‰ ç¯å¢ƒéªŒè¯å®Œæˆï¼Œå¯ä»¥å¼€å§‹ä½¿ç”¨IMæ£€æµ‹å™¨ï¼")

  if __name__ == "__main__":
      main()

  ğŸ“Š æ€»ç»“å»ºè®®

  | ç¯å¢ƒ     | Pythonç‰ˆæœ¬ | å®‰è£…æ–¹å¼  | é€‚ç”¨åœºæ™¯ |
  |--------|----------|-------|------|
  | å¼€å‘ç¯å¢ƒ   | 3.10.x   | conda | æ¨è   |
  | ç”Ÿäº§ç¯å¢ƒ   | 3.9.x    | venv  | ç¨³å®š   |
  | æµ‹è¯•ç¯å¢ƒ   | 3.8.x    | pip   | æœ€å°è¦æ±‚ |
  | Docker | 3.10.x   | å®¹å™¨åŒ–   | éƒ¨ç½²   |

  æœ€ä½³å®è·µï¼š
  1. ä½¿ç”¨Python 3.10ï¼ˆå…¼å®¹æ€§æœ€å¥½ï¼‰
  2. ç”¨condaç®¡ç†ç¯å¢ƒï¼ˆä¾èµ–å†²çªå°‘ï¼‰
  3. å…ˆè£…PyTorchå†è£…å…¶ä»–åŒ…
  4. åˆ›å»ºç‹¬ç«‹è™šæ‹Ÿç¯å¢ƒ
